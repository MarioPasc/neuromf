# VAE Validation Configuration
# Merged with base.yaml at runtime via OmegaConf.merge(base, vae_validation)

vae:
  # Architecture args (must match config_network_rflow.json exactly)
  spatial_dims: 3
  in_channels: 1
  out_channels: 1
  latent_channels: 4
  num_channels: [64, 128, 256]
  num_res_blocks: [2, 2, 2]
  norm_num_groups: 32
  norm_eps: 1.0e-6
  attention_levels: [false, false, false]
  with_encoder_nonlocal_attn: false
  with_decoder_nonlocal_attn: false
  use_checkpointing: false
  use_convtranspose: false
  norm_float16: false
  num_splits: 6              # 192/6=32 per split (same per-split depth as 128/4)
  dim_split: 1

  # Scaling
  scale_factor: 0.96240234375
  downsample_factor: 4

data:
  n_validation: 20
  target_shape: [192, 192, 192]
  target_spacing: [1.0, 1.0, 1.0]
  intensity_lower_percentile: 0.0
  intensity_upper_percentile: 99.5
  intensity_b_min: 0.0
  intensity_b_max: 1.0

output:
  metrics_dir: "${paths.results_root}/phase_0/vae_validation/metrics"
  reconstructions_dir: "${paths.results_root}/phase_0/vae_validation/reconstructions"
  figures_dir: "${paths.results_root}/phase_0/vae_validation/figures"
  latent_stats_dir: "${paths.results_root}/phase_0/vae_validation/latent_stats"
  report_html: "${paths.results_root}/phase_0/verification_report.html"
  report_md: "${paths.project_root}/experiments/phase_0/verification_report.md"
  n_save_per_dataset: 2  # save at least 2 reconstruction examples per FOMO-60K dataset
